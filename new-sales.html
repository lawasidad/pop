<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>فرۆشتنی کاڵا</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #f2f2f2;
      color: #333;
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 30px 20px;
    }

    h2 {
      text-align: center;
      color: #005f73;
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
    }

    input[type="text"],
    input[type="number"] {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .search-box {
      margin-bottom: 20px;
    }

    .products {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }

    .product-card {
      flex: 1 1 calc(50% - 15px);
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 0 8px rgba(0,0,0,0.05);
    }

    .product-name {
      font-weight: bold;
      font-size: 1.1rem;
      margin-bottom: 5px;
    }

    .price {
      color: #0a9396;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
    }

    .controls input {
      width: 60px;
      padding: 5px;
      text-align: center;
    }

    .total {
      margin-top: 30px;
      font-size: 1.2rem;
      text-align: center;
      color: #005f73;
    }

    .submit-btn {
      display: block;
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      background-color: #005f73;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
      transition: 0.3s;
    }

    .submit-btn:hover {
      background-color: #0a9396;
    }

    @media (max-width: 600px) {
      .product-card {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>فۆرمی فرۆشتن</h2>

    <div class="form-group">
      <label for="customer">ناوی کریار</label>
      <input type="text" id="customer" placeholder="ناوی کریار بنووسە" />
    </div>

    <div class="form-group search-box">
      <label for="searchProduct">گەڕان بۆ کاڵا</label>
      <input type="text" id="searchProduct" placeholder="ناوی کاڵا بنووسە..." />
    </div>

    <div class="products" id="productsList"></div>

    <div class="total" id="totalAmount">کۆی گشتی: 0 دینار</div>

    <button class="submit-btn" id="submitBtn">تۆمارکردنی فرۆشتن</button>
  </div>

<script>
  const products = [
    { id: 1, name: "کالای ١", price: 2000 },
    { id: 2, name: "کالای ٢", price: 3500 },
    { id: 3, name: "کالای ٣", price: 5000 },
    { id: 4, name: "کالای ٤", price: 1500 },
    { id: 5, name: "کالای ٥", price: 8000 },
  ];

  let cart = products.map(p => ({ ...p, qty: 0, discount: 0 }));
  let filteredCart = [...cart];

  const productsList = document.getElementById("productsList");
  const totalAmount = document.getElementById("totalAmount");
  const searchInput = document.getElementById("searchProduct");
  const customerInput = document.getElementById("customer");
  const submitBtn = document.getElementById("submitBtn");

  function renderProducts() {
    productsList.innerHTML = "";
    filteredCart.forEach(product => {
      const total = product.qty * product.price * (1 - product.discount / 100);
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <div class="product-name">${product.name}</div>
        <div class="price">نرخی یەکە: ${product.price.toLocaleString()} دینار</div>
        <div class="controls">
          <label>ژمارە:</label>
          <input type="number" min="0" value="${product.qty}" data-id="${product.id}" class="qty" />
          <label>داشکاندن٪:</label>
          <input type="number" min="0" max="100" value="${product.discount}" data-id="${product.id}" class="discount" />
        </div>
        <div style="margin-top: 10px; font-weight: bold;">کۆ: ${total.toLocaleString()} دینار</div>
      `;
      productsList.appendChild(card);
    });
    updateTotal();
  }

  function updateTotal() {
    const total = cart.reduce((sum, item) => {
      return sum + (item.qty * item.price * (1 - item.discount / 100));
    }, 0);
    totalAmount.textContent = `کۆی گشتی: ${total.toLocaleString()} دینار`;
  }

  productsList.addEventListener("input", (e) => {
    const id = parseInt(e.target.dataset.id);
    const index = cart.findIndex(p => p.id === id);
    if (e.target.classList.contains("qty")) {
      cart[index].qty = parseInt(e.target.value) || 0;
    } else if (e.target.classList.contains("discount")) {
      cart[index].discount = parseFloat(e.target.value) || 0;
    }
    renderProducts();
  });

  searchInput.addEventListener("input", () => {
    const q = searchInput.value.trim().toLowerCase();
    filteredCart = cart.filter(p => p.name.toLowerCase().includes(q));
    renderProducts();
  });

  submitBtn.addEventListener("click", () => {
    const customer = customerInput.value.trim();
    if (!customer) {
      alert("تکایە ناوی کریار بنووسە");
      return;
    }

    const items = cart.filter(p => p.qty > 0).map(p => ({
      product: p.name,
      qty: p.qty,
      unitPrice: p.price,
      discount: p.discount,
      total: p.qty * p.price * (1 - p.discount / 100)
    }));

    if (items.length === 0) {
      alert("هیچ کاڵایەکت هەلبژێردراووە!");
      return;
    }

    const newSales = items.map(item => ({
      customer,
      ...item
    }));

    const existing = JSON.parse(localStorage.getItem("salesList") || "[]");
    const updated = [...existing, ...newSales];
    localStorage.setItem("salesList", JSON.stringify(updated));

    alert("فرۆشتن تۆمار کرا!");

    // reset form
    customerInput.value = "";
    cart = products.map(p => ({ ...p, qty: 0, discount: 0 }));
    filteredCart = [...cart];
    renderProducts();
  });

  renderProducts();
</script>
</body>
</html>
