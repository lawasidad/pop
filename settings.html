<!-- Sales Report Section -->
<section id="salesSection" class="section">
  <h1>Sales Report</h1>

  <!-- Date range filter inputs -->
  <div class="date-filter-container" style="display:flex; gap:20px; max-width:400px; margin-bottom:20px;">
    <label>
      From:
      <input type="date" id="dateFrom" />
    </label>
    <label>
      To:
      <input type="date" id="dateTo" />
    </label>
  </div>

  <!-- Sales by Item -->
  <h2>Sales by Item</h2>
  <input type="text" id="filterSalesByItem" class="filter-input" placeholder="Filter by item name..." />
  <table id="salesByItemTable" style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Item</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Quantity Sold</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Total Sales</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Date</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="padding:8px;">Example Item 1</td><td style="padding:8px;">10</td><td style="padding:8px;">$100</td><td style="padding:8px;">2025-06-01</td></tr>
      <tr><td style="padding:8px;">Example Item 2</td><td style="padding:8px;">5</td><td style="padding:8px;">$50</td><td style="padding:8px;">2025-06-05</td></tr>
      <tr><td style="padding:8px;">Example Item 3</td><td style="padding:8px;">7</td><td style="padding:8px;">$70</td><td style="padding:8px;">2025-06-03</td></tr>
    </tbody>
  </table>

  <!-- Sales by Invoice -->
  <h2>Sales by Invoice</h2>
  <input type="text" id="filterSalesByInvoice" class="filter-input" placeholder="Filter by invoice number..." />
  <table id="salesByInvoiceTable" style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Invoice Number</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Date</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="padding:8px;">INV001</td><td style="padding:8px;">2025-06-01</td><td style="padding:8px;">$150</td></tr>
      <tr><td style="padding:8px;">INV002</td><td style="padding:8px;">2025-06-02</td><td style="padding:8px;">$100</td></tr>
      <tr><td style="padding:8px;">INV003</td><td style="padding:8px;">2025-06-06</td><td style="padding:8px;">$200</td></tr>
    </tbody>
  </table>

  <!-- Sales by Amount -->
  <h2>Sales by Amount</h2>
  <input type="text" id="filterSalesByAmount" class="filter-input" placeholder="Filter by customer name..." />
  <table id="salesByAmountTable" style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Customer</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Total Amount</th>
        <th style="border-bottom:1px solid #ddd; padding:8px;">Date</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="padding:8px;">Customer A</td><td style="padding:8px;">$250</td><td style="padding:8px;">2025-06-01</td></tr>
      <tr><td style="padding:8px;">Customer B</td><td style="padding:8px;">$100</td><td style="padding:8px;">2025-06-04</td></tr>
      <tr><td style="padding:8px;">Customer C</td><td style="padding:8px;">$300</td><td style="padding:8px;">2025-06-06</td></tr>
    </tbody>
  </table>
</section>

<style>
  /* Filter input styles */
  .filter-input {
    width: 100%;
    max-width: 300px;
    margin-bottom: 10px;
    padding: 6px 10px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  /* Table row hover with no dark colors */
  #salesByItemTable tbody tr:hover,
  #salesByInvoiceTable tbody tr:hover,
  #salesByAmountTable tbody tr:hover {
    background-color: #f2f2f2; /* light grey */
  }
</style>

<script>
  // Utility function to check if date is within range (inclusive)
  function isDateInRange(dateStr, from, to) {
    if (!from && !to) return true;
    const date = new Date(dateStr);
    if (from && date < new Date(from)) return false;
    if (to && date > new Date(to)) return false;
    return true;
  }

  // Generic filter function for table rows
  function filterTableRows(tableId, filterText, dateFrom, dateTo, dateColumnIndex, filterColumnsIndexes) {
    const table = document.getElementById(tableId);
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);

    rows.forEach(row => {
      // Filter text check (search on specified columns)
      const textMatch = filterColumnsIndexes.some(colIndex => {
        const cellText = row.cells[colIndex].textContent.toLowerCase();
        return cellText.includes(filterText.toLowerCase());
      });

      // Filter date check
      const dateText = row.cells[dateColumnIndex].textContent;
      const dateMatch = isDateInRange(dateText, dateFrom, dateTo);

      // Show row only if both match
      if (textMatch && dateMatch) {
        row.style.display = '';
        row.style.backgroundColor = '';  // Reset background
      } else {
        row.style.display = 'none';
      }
    });
  }

  // Setup filter event listeners for each sales table
  function setupSalesFilters() {
    // Sales by Item
    const filterItemInput = document.getElementById('filterSalesByItem');
    const dateFromInput = document.getElementById('dateFrom');
    const dateToInput = document.getElementById('dateTo');

    function applyFiltersSalesByItem() {
      filterTableRows(
        'salesByItemTable',
        filterItemInput.value,
        dateFromInput.value,
        dateToInput.value,
        3, // Date column index in salesByItemTable
        [0] // Filter only by Item column
      );
    }

    filterItemInput.addEventListener('input', applyFiltersSalesByItem);
    dateFromInput.addEventListener('change', applyFiltersSalesByItem);
    dateToInput.addEventListener('change', applyFiltersSalesByItem);

    // Sales by Invoice
    const filterInvoiceInput = document.getElementById('filterSalesByInvoice');

    function applyFiltersSalesByInvoice() {
      filterTableRows(
        'salesByInvoiceTable',
        filterInvoiceInput.value,
        dateFromInput.value,
        dateToInput.value,
        1, // Date column index in salesByInvoiceTable
        [0] // Filter by Invoice Number column
      );
    }

    filterInvoiceInput.addEventListener('input', applyFiltersSalesByInvoice);
    dateFromInput.addEventListener('change', applyFiltersSalesByInvoice);
    dateToInput.addEventListener('change', applyFiltersSalesByInvoice);

    // Sales by Amount
    const filterAmountInput = document.getElementById('filterSalesByAmount');

    function applyFiltersSalesByAmount() {
      filterTableRows(
        'salesByAmountTable',
        filterAmountInput.value,
        dateFromInput.value,
        dateToInput.value,
        2, // Date column index in salesByAmountTable
        [0] // Filter by Customer column
      );
    }

    filterAmountInput.addEventListener('input', applyFiltersSalesByAmount);
    dateFromInput.addEventListener('change', applyFiltersSalesByAmount);
    dateToInput.addEventListener('change', applyFiltersSalesByAmount);
  }

  // Initialize filters when DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    setupSalesFilters();
  });
</script>
