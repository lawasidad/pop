// Load users from localStorage and display in table
function loadUsers() {
  const users = JSON.parse(localStorage.getItem('users') || '[]');
  userTableBody.innerHTML = '';
  users.forEach(user => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${user.name}</td><td>${user.role}</td><td>${user.mobile}</td>`;
    userTableBody.appendChild(tr);
  });
}

// Check if username already exists
function userExists(name) {
  const users = JSON.parse(localStorage.getItem('users') || '[]');
  return users.some(u => u.name.toLowerCase() === name.toLowerCase());
}

userForm.addEventListener('submit', event => {
  event.preventDefault();
  const name = document.getElementById('userName').value.trim();
  const password = document.getElementById('userPassword').value.trim();
  const role = document.getElementById('userRole').value;
  const mobile = document.getElementById('userMobile').value.trim();

  if (!name || !password || !role || !mobile) {
    alert('Please fill all fields correctly.');
    return;
  }

  if (userExists(name)) {
    alert('User with this name already exists.');
    return;
  }

  // Save user including password
  const users = JSON.parse(localStorage.getItem('users') || '[]');
  users.push({ name, password, role, mobile });
  localStorage.setItem('users', JSON.stringify(users));

  userForm.reset();
  loadUsers();
});

loadUsers();
