<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard with Users, Company, Sales Report</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      height: 100vh;
      background-color: #f0f2f5;
    }
    .sidebar {
      width: 220px;
      background-color: #2c3e50;
      color: white;
      display: flex;
      flex-direction: column;
    }
    .sidebar h2 {
      text-align: center;
      margin: 0;
      padding: 20px;
      border-bottom: 1px solid #34495e;
    }
    .sidebar button {
      padding: 15px 20px;
      background: none;
      border: none;
      color: white;
      font-size: 16px;
      text-align: left;
      cursor: pointer;
      border-bottom: 1px solid #34495e;
      transition: background-color 0.3s ease;
    }
    .sidebar button:hover,
    .sidebar button.active {
      background-color: #34495e;
    }
    .main-content {
      flex-grow: 1;
      padding: 30px;
      background: white;
      overflow-y: auto;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    h1 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #333;
    }
    form {
      margin-bottom: 30px;
      max-width: 600px;
    }
    label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      color: #555;
    }
    input[type="text"],
    input[type="password"],
    input[type="tel"],
    input[type="file"],
    select,
    input[type="date"] {
      width: 100%;
      padding: 8px 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    button.submit-btn {
      background-color: #2980b9;
      border: none;
      color: white;
      padding: 10px 20px;
      font-size: 15px;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }
    button.submit-btn:hover {
      background-color: #3498db;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid #ddd;
      color: #444;
    }
    th {
      background-color: #f7f7f7;
    }
    tr:hover {
      background-color: #f1f1f1;
    }
    #logoPreview {
      max-width: 150px;
      max-height: 80px;
      display: block;
      margin-top: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Dashboard</h2>
    <button data-target="usersSection">Users</button>
    <button data-target="companySection">Company</button>
    <button data-target="salesSection">Sales Report</button>
  </div>

  <!-- Main content -->
  <div class="main-content">

    <!-- Users Section -->
    <section id="usersSection" class="section">
      <h1>Users</h1>
      <form id="userForm">
        <label for="userName">Name</label>
        <input type="text" id="userName" required />

        <label for="userPassword">Password</label>
        <input type="password" id="userPassword" required />

        <label for="userRole">Role</label>
        <select id="userRole" required>
          <option value="">Select role</option>
          <option value="Admin">Admin</option>
          <option value="Manager">Manager</option>
          <option value="Sales">Sales</option>
        </select>

        <label for="userMobile">Mobile Number</label>
        <input type="tel" id="userMobile" pattern="[0-9]{10,15}" placeholder="e.g. 1234567890" required />

        <button type="submit" class="submit-btn">Add User</button>
      </form>

      <h2>User List</h2>
      <table id="userListTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Role</th>
            <th>Mobile Number</th>
          </tr>
        </thead>
        <tbody>
          <!-- Users will be added here dynamically -->
        </tbody>
      </table>
    </section>

    <!-- Company Section -->
    <section id="companySection" class="section">
      <h1>Company</h1>
      <form id="companyForm">
        <label for="companyName">Company Name</label>
        <input type="text" id="companyName" required />

        <label for="companyAddress">Address</label>
        <input type="text" id="companyAddress" required />

        <label for="companyLogo">Logo</label>
        <input type="file" id="companyLogo" accept="image/*" />

        <img id="logoPreview" alt="Logo Preview" src="" style="display:none" />

        <button type="submit" class="submit-btn">Save Company Info</button>
      </form>
    </section>

    <!-- Sales Report Section -->
    <section id="salesSection" class="section">
      <h1>Sales Report</h1>

      <!-- Date filter -->
      <form id="salesFilterForm">
        <label for="filterDate">Filter by Date:</label>
        <input type="date" id="filterDate" />
        <button type="submit" class="submit-btn" style="width: auto;">Filter</button>
        <button type="button" id="clearFilter" class="submit-btn" style="background-color: #7f8c8d; margin-left: 10px;">Clear</button>
      </form>

      <h2>Sales by Item</h2>
      <table id="salesByItemTable">
        <thead>
          <tr>
            <th>Item</th>
            <th>Quantity Sold</th>
            <th>Total Sales</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Example Item 1</td><td>10</td><td>$100</td><td>2025-06-01</td></tr>
          <tr><td>Example Item 2</td><td>5</td><td>$50</td><td>2025-06-02</td></tr>
        </tbody>
      </table>

      <h2>Sales by Invoice</h2>
      <table id="salesByInvoiceTable">
        <thead>
          <tr>
            <th>Invoice Number</th>
            <th>Date</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>INV001</td><td>2025-06-01</td><td>$150</td></tr>
          <tr><td>INV002</td><td>2025-06-02</td><td>$100</td></tr>
        </tbody>
      </table>

      <h2>Sales by Amount</h2>
      <table id="salesByAmountTable">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Total Amount</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Customer A</td><td>$250</td><td>2025-06-01</td></tr>
          <tr><td>Customer B</td><td>$100</td><td>2025-06-02</td></tr>
        </tbody>
      </table>
    </section>

  </div>

  <script>
    // Sidebar button click handler
    const sidebarButtons = document.querySelectorAll('.sidebar button');
    const sections = document.querySelectorAll('.section');

    sidebarButtons.forEach(button => {
      button.addEventListener('click', () => {
        // Remove active class from all buttons
        sidebarButtons.forEach(btn => btn.classList.remove('active'));
        // Add active to clicked button
        button.classList.add('active');

        // Hide all sections
        sections.forEach(section => section.classList.remove('active'));
        // Show targeted section
        const target = button.getAttribute('data-target');
        document.getElementById(target).classList.add('active');
      });
    });

    // Set default active section (Users)
    sidebarButtons[0].click();

    // USER FORM HANDLING WITH localStorage
    const userForm = document.getElementById('userForm');
    const userListTableBody = document.querySelector('#userListTable tbody');

    // Load users from localStorage on page load
    function loadUsers() {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      userListTableBody.innerHTML = ''; // Clear current list
      users.forEach(user => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `
          <td>${user.name}</td>
          <td>${user.role}</td>
          <td>${user.mobile}</td>
        `;
        userListTableBody.appendChild(newRow);
      });
    }
    loadUsers();

    userForm.addEventListener('submit', function(event) {
      event.preventDefault();

      // Get input values
      const name = document.getElementById('userName').value.trim();
      const password = document.getElementById('userPassword').value; // Not stored for privacy
      const role = document.getElementById('userRole').value;
      const mobile = document.getElementById('userMobile').value.trim();

      if (!name || !password || !role || !mobile) {
        alert('Please fill all fields correctly.');
        return;
      }

      // Retrieve existing users
      const users = JSON.parse(localStorage.getItem('users') || '[]');

      // Add new user to array
      users.push({ name, role, mobile });

      // Save back to localStorage
      localStorage.setItem('users', JSON.stringify(users));

      // Update UI immediately
      loadUsers();

      // Reset form
      userForm.reset();
    });

    // COMPANY FORM HANDLING WITH localStorage for name, address, logo
    const companyForm = document.getElementById('companyForm');
    const logoInput = document.getElementById('companyLogo');
    const logoPreview = document.getElementById('logoPreview');

    // Load company info from localStorage on page load
    function loadCompanyInfo() {
      const companyInfo = JSON.parse(localStorage.getItem('companyInfo') || '{}');
      if (companyInfo.name) {
        document.getElementById('companyName').value = companyInfo.name;
      }
      if (companyInfo.address) {
        document.getElementById('companyAddress').value = companyInfo.address;
      }
      if (companyInfo.logo) {
        logoPreview.src = companyInfo.logo;
        logoPreview.style.display = 'block';
      } else {
        logoPreview.style.display = 'none';
      }
    }
    loadCompanyInfo();

    logoInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          logoPreview.src = e.target.result;
          logoPreview.style.display = 'block';
          // Save logo immediately in localStorage
          const companyInfo = JSON.parse(localStorage.getItem('companyInfo') || '{}');
          companyInfo.logo = e.target.result;
          localStorage.setItem('companyInfo', JSON.stringify(companyInfo));
        }
        reader.readAsDataURL(file);
      } else {
        logoPreview.src = '';
        logoPreview.style.display = 'none';
        const companyInfo = JSON.parse(localStorage.getItem('companyInfo') || '{}');
        delete companyInfo.logo;
        localStorage.setItem('companyInfo', JSON.stringify(companyInfo));
      }
    });

    companyForm.addEventListener('submit', function(event) {
      event.preventDefault();

      const companyName = document.getElementById('companyName').value.trim();
      const companyAddress = document.getElementById('companyAddress').value.trim();

      if (!companyName || !companyAddress) {
        alert('Please fill company name and address.');
        return;
      }

      const companyInfo = JSON.parse(localStorage.getItem('companyInfo
